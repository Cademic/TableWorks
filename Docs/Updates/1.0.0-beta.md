# 1.0.0-beta — Patch Notes

Patch notes for the 1.0.0-beta release. This document summarizes the changes made to the website and backend in this release.

---

## Pinned Projects (like Pinned Boards)

### Backend
- **UserPinnedProjects** table: junction table for per-user project pinning (`UserId`, `ProjectId`, `PinnedAt`).
- **Migration:** `AddProjectPinning` creates `UserPinnedProjects` with composite PK and FKs to Users and Projects (cascade delete).
- **API:**
  - `PUT api/v1/projects/{id}/pin` — body `{ "isPinned": boolean }` — toggles pin for the current user.
  - `GET api/v1/projects/pinned` — returns the current user’s pinned projects.
- **Route order:** `GET projects/pinned` is registered with `Order = 0` so it is matched before `GET projects/{id:guid}` (avoids "pinned" being treated as an id).
- **Resilience:** When the `UserPinnedProjects` table is missing (migration not applied), `GetProjects` and `GetPinnedProjects` return data without pin info; `TogglePin` no-ops so the API returns 200 instead of 500.

### Frontend
- **Types:** `ProjectSummaryDto` includes optional `isPinned` and `pinnedAt`.
- **API:** `getPinnedProjects()` and `toggleProjectPin(id, isPinned)` in `api/projects.ts`.
- **Layout:** AppLayout fetches and exposes `pinnedProjects` and `refreshPinnedProjects`; Sidebar shows a **Pinned Projects** section (above Pinned Boards) with links to `/projects/{id}`.

---

## Project Card Ellipsis Menu

- **ProjectCard** (dashboard and projects page):
  - Three-dot (⋮) menu with **Rename**, **Pin to Sidebar** / **Unpin from Sidebar**, and **Delete** (owner only when `onDelete` is provided).
  - Pin icon on the card when `project.isPinned` is true.
  - Card wrapper changed from `<button>` to `<div role="button">` so menu actions are not nested buttons (fixes DOM nesting warning and ensures Pin/Rename/Delete clicks work).
- **Dashboard:** Project rename dialog, `handleRenameProject` / `confirmRenameProject`, `handleToggleProjectPin`, `handleDeleteProject` / `confirmDeleteProject`; all passed into `ProjectCard`.
- **Projects page:** Same rename, pin, and delete handlers; uses `refreshPinnedProjects` from outlet context after pin/delete.

---

## Boards: Combined Section and “View All Boards”

- **Dashboard:** Note Boards and Chalk Boards are merged into a single **Boards** section. Boards are sorted by last updated; first 6 are shown with a **View All Boards** button linking to `/boards`.
- **New route and page:** `GET /boards` → **BoardsPage** with:
  - Filter pills: **All** | **Note Boards** | **Chalk Boards**.
  - Grid of board cards (same behavior as dashboard: rename, delete, pin, move to project).
  - **New Board** button opening the existing create-board dialog.
- **Router:** Route `/boards` is registered before `/boards/:boardId` so the list page is matched correctly.

---

## Dashboard Sorting

- **Boards:** Sorted by `updatedAt` descending (most recently updated / “opened recently” first).
- **Projects:** Sorted by `createdAt` descending for display (Projects section and MiniCalendar use `activeProjectsSorted`).

---

## Project Name on Board Cards

- When a board is in a project (`board.projectId` set), the **project name** is shown in the top-right of the board card on the dashboard (and on the Boards page), resolved from `activeProjects`.

---

## Board Card Nested Button Fix

- **BoardCard** outer wrapper changed from `<button>` to `<div role="button">` with `tabIndex={0}` and keyboard support so the ellipsis menu items (Rename, Move to Project, Pin, Delete) are not nested inside a button. Fixes the “button cannot appear as a descendant of button” warning and ensures menu actions work.

---

## React Router Future Flags

- **BrowserRouter** now passes `future={{ v7_startTransition: true, v7_relativeSplatPath: true }}` to opt in to v7 behavior and silence the corresponding console warnings.

---

## Backend / Database and Docs

- **README (backend):**
  - Correct project paths: `src/TableWorks.API/` and `src/TableWorks.Infrastructure/` (not `ASideNote.API` folder names).
  - All EF and run commands shown as single-line so they work in PowerShell.
  - New **“If the database isn’t updating”** section: run from `Source/backend/`, check pending migrations, and ensure connection matches app (e.g. `.env`).
- **AddProjectPinning migration:** Hand-written migration was not discovered by EF. Added `[Migration("20260213120000_AddProjectPinning")]` and `[DbContext(typeof(AppDbContext))]` (and required usings) so `dotnet ef database update` applies it.
- **AppDbContextModelSnapshot:** Updated to include **UserPinnedProjects** entity, its relationships to Project and User, and the `PinnedByUsers` / `PinnedProjects` navigations so future `dotnet ef migrations add` only generates changes for new tables/columns and does not try to recreate `UserPinnedProjects`.

---

## Open Board or Project Immediately After Creation

- **Boards:** After creating a note board or chalk board, the user is navigated directly to the new board (`/boards/:id` or `/chalkboards/:id`). Applied on Dashboard, Boards page, Chalk Boards page, and when creating a board within a project.
- **Projects:** After creating a project, the user is navigated directly to the new project (`/projects/:id`). Applied on Dashboard and Projects page.

---

## Chalk Board: Virtual Canvas Resolution and Zoom

- **Higher virtual canvas resolution:** The Chalk Board canvas is now 2× the display size internally. Strokes drawn at 25% zoom stay crisp when zooming in to 200%, matching the quality of strokes drawn at full zoom.
- **Retina scaling:** Fabric.js `enableRetinaScaling` enabled for sharp rendering on high-DPI displays.
- **Zoom behavior:** Ctrl/Cmd + scroll zooms centered on the cursor (same as Note Boards). Zoom buttons zoom centered on the viewport.
- **Migration:** Existing drawings and notes are scaled on load to the new coordinate system. New saves include a version field for future compatibility.

---

## Summary

| Area            | Change                                                                 |
|-----------------|-----------------------------------------------------------------------|
| Projects        | Pinned projects (sidebar, API, DB table, resilience when table missing) |
| Project cards   | Ellipsis menu (Rename, Pin/Unpin, Delete), pin indicator, no nested buttons |
| Boards (UI)     | Single Boards section on dashboard, View All Boards → `/boards`, filter (All / Note / Chalk) |
| Boards (cards)  | Project name on card when in a project; BoardCard not a button to fix menu clicks |
| Dashboard       | Boards/projects sorted by “opened recently”; project rename/pin/delete flows |
| Create flow     | Boards and projects open immediately after creation                   |
| Chalk Board     | Virtual 2× canvas resolution; crisp strokes at all zoom levels; zoom on cursor |
| Router          | `/boards` list page; React Router v7 future flags                     |
| Backend / EF    | Route order for `projects/pinned`, migration discovery, snapshot for UserPinnedProjects |
| Docs            | README paths and PowerShell commands, migration troubleshooting       |
